{% extends 'base.html.twig' %}

{% block title %}Clients
{% endblock %}

{% block body %}
<h1 class='my-5'>Mes clients</h1>


<table class="table">
    <thead>
        <tr>
            <th></th>
            <th>
                <button class="btn btn-outline-warning" id="js-detail-contact">Voir le détail du contact</button>
            </th>
            <th>
                <button name="projetId" class="btn btn-outline-warning js-detail-projets" id="js-detail-projets">Voir
                    les projets associés</button>
            </th>
        </tr>
    </thead>
    <tbody>
        {% for client in clients %}
        <tr>
            <td>{{ client.name }}</td>
            <td>
                <ul class="list-group js-li-detail-contact" style='display:none'>
                    <li class="list-group-item">Nom : <a href="{{ path('client_show', {'id': client.id}) }}">{{ client.name }}</a> </li>
                    <li class="list-group-item">Adresse : {{ client.adresse }} <br /> {{ client.zip }} {{ client.city }}
                    </li>
                    <li class="list-group-item">Téléphone : {{ client.phone }}</li>
                    <li class="list-group-item">E-mail : {{ client.mail }}</li>
                    <li class="list-group-item">
                        <a class="btn btn-outline-secondary"
                            href="{{ path('client_edit', {'id': client.id}) }}">Modifier les coordonnées</a>
                    </li>
                </ul>
            </td>
            <td>
                <ul id="js-ul-detail-projets" class="list-group list-group-flush js-ul-detail-projets">
                    {% for projet in projets %}
                    {% if projet.IdClient.id == client.id %}
                    <li class="list-group-item js-li-detail-projets" id="js-li-detail-projets" style='display:none'>
                        <a class="list-group-item"
                            href="{{ path('tasks_index', {'id': projet.id}) }}">{{ projet.name }}</a>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>

            </td>

        </tr>
        {% else %}

        <tr>
            <td colspan="8">Aucun client n'a été trouvé.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
{% block javascripts %}
<script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<script>
    $(document).ready(function () {
        $("#js-detail-projets").click(function () {
            $(".js-li-detail-projets").toggle();
        })
        $("#js-detail-contact").click(function () {
            $(".js-li-detail-contact").toggle();

        })
    })
</script>
{% endblock %}